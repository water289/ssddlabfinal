global:
  imagePullSecrets: []
  secretKey: "change-me"
  database:
    host: "voting-system-postgresql"  # ⬅️ Changed to match Bitnami naming
    user: "postgres"
    password: "postgres"
    name: "voting"
    port: 5432
  frontendOrigins: "http://localhost:5173"
  voteEncryptionKey: "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="

backend:
  image: "secure-voting-backend:latest"
  replicaCount: 2
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false
    capabilities:
      drop:
        - ALL
  rateLimit:
    enabled: true
    perMinute: 120

frontend:
  image: "secure-voting-frontend:latest"
  replicaCount: 2
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false
    capabilities:
      drop:
        - ALL
  apiUrl: "http://voting-system-backend:8000"

# ========== USE BITNAMI POSTGRESQL CHART ==========
postgresql:
  enabled: true
  auth:
    enablePostgresUser: true
    postgresPassword: "postgres"
    username: "postgres"
    password: "postgres"
    database: "voting"
  
  primary:
    # Disable container security context (let volumePermissions handle it)
    containerSecurityContext:
      enabled: false
    
    # Enable pod security context
    podSecurityContext:
      enabled: true
      fsGroup: 1001
    
    # Resource limits
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 1Gi
    
    # Persistence
    persistence:
      enabled: true
      size: 2Gi
  
  # ⬅️ CRITICAL: Enable volume permissions init container
  volumePermissions:
    enabled: true
    securityContext:
      runAsUser: 0
      runAsNonRoot: false

service:
  type: ClusterIP
