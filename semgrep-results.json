{"version":"1.146.0","results":[{"check_id":"generic.secrets.security.detected-private-key.detected-private-key","path":"SSDD.pem","start":{"line":1,"col":1,"offset":0},"end":{"line":2,"col":35,"offset":67},"extra":{"message":"Private Key detected. This is a sensitive credential and should not be hardcoded here. Instead, store this in a separate, private file.","metadata":{"cwe":["CWE-798: Use of Hard-coded Credentials"],"source-rule-url":"https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go","category":"security","technology":["secrets"],"confidence":"LOW","owasp":["A07:2021 - Identification and Authentication Failures"],"references":["https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Hard-coded Secrets"],"source":"https://semgrep.dev/r/generic.secrets.security.detected-private-key.detected-private-key","shortlink":"https://sg.run/b7dr"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.docker-compose.security.no-new-privileges.no-new-privileges","path":"docker\\docker-compose.yml","start":{"line":3,"col":3,"offset":29},"end":{"line":3,"col":5,"offset":31},"extra":{"message":"Service 'db' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/","https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"],"category":"security","technology":["docker-compose"],"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges","shortlink":"https://sg.run/0n8q"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service","path":"docker\\docker-compose.yml","start":{"line":3,"col":3,"offset":29},"end":{"line":3,"col":5,"offset":31},"extra":{"message":"Service 'db' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.","metadata":{"cwe":["CWE-732: Incorrect Permission Assignment for Critical Resource"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"references":["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir","https://blog.atomist.com/security-of-docker-kubernetes/","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"],"category":"security","technology":["docker-compose"],"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service","shortlink":"https://sg.run/e4JE"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.kubernetes.security.run-as-non-root.run-as-non-root","path":"docker\\k8s\\policies\\disallow-privileged.yaml","start":{"line":16,"col":11,"offset":342},"end":{"line":16,"col":15,"offset":346},"extra":{"message":"When running containers in Kubernetes, it's important to ensure that they  are properly secured to prevent privilege escalation attacks.  One potential vulnerability is when a container is allowed to run  applications as the root user, which could allow an attacker to gain  access to sensitive resources. To mitigate this risk, it's recommended to  add a `securityContext` to the container, with the parameter `runAsNonRoot`  set to `true`. This will ensure that the container runs as a non-root user,  limiting the damage that could be caused by any potential attacks. By  adding a `securityContext` to the container in your Kubernetes pod, you can  help to ensure that your containerized applications are more secure and  less vulnerable to privilege escalation attacks.","fix":"spec:\n            securityContext:\n              runAsNonRoot: true #","metadata":{"references":["https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/","https://kubernetes.io/docs/concepts/policy/pod-security-policy/","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-2-set-a-user"],"category":"security","cwe":["CWE-250: Execution with Unnecessary Privileges"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"technology":["kubernetes"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.kubernetes.security.run-as-non-root.run-as-non-root","shortlink":"https://sg.run/dgP5"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"yaml.kubernetes.security.run-as-non-root.run-as-non-root","path":"docker\\k8s\\policies\\require-resource-limits.yaml","start":{"line":16,"col":11,"offset":341},"end":{"line":16,"col":15,"offset":345},"extra":{"message":"When running containers in Kubernetes, it's important to ensure that they  are properly secured to prevent privilege escalation attacks.  One potential vulnerability is when a container is allowed to run  applications as the root user, which could allow an attacker to gain  access to sensitive resources. To mitigate this risk, it's recommended to  add a `securityContext` to the container, with the parameter `runAsNonRoot`  set to `true`. This will ensure that the container runs as a non-root user,  limiting the damage that could be caused by any potential attacks. By  adding a `securityContext` to the container in your Kubernetes pod, you can  help to ensure that your containerized applications are more secure and  less vulnerable to privilege escalation attacks.","fix":"spec:\n            securityContext:\n              runAsNonRoot: true #","metadata":{"references":["https://kubernetes.io/blog/2016/08/security-best-practices-kubernetes-deployment/","https://kubernetes.io/docs/concepts/policy/pod-security-policy/","https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-2-set-a-user"],"category":"security","cwe":["CWE-250: Execution with Unnecessary Privileges"],"owasp":["A05:2021 - Security Misconfiguration","A06:2017 - Security Misconfiguration"],"technology":["kubernetes"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/yaml.kubernetes.security.run-as-non-root.run-as-non-root","shortlink":"https://sg.run/dgP5"},"severity":"INFO","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"dockerfile.security.missing-user.missing-user","path":"src\\backend\\Dockerfile","start":{"line":8,"col":1,"offset":169},"end":{"line":8,"col":22,"offset":190},"extra":{"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [\"/app/start.sh\"]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"dockerfile.security.missing-user.missing-user","path":"src\\frontend\\Dockerfile","start":{"line":13,"col":1,"offset":305},"end":{"line":13,"col":35,"offset":339},"extra":{"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [\"nginx\", \"-g\", \"daemon off;\"]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line docker\\helm\\voting-system\\templates\\backend-deployment.yaml:4:\n (approximate error location; error nearby after) error calling parser: did not find expected key character 0 position 0 returned: 0","path":"docker\\helm\\voting-system\\templates\\backend-deployment.yaml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line docker\\helm\\voting-system\\templates\\backend-hpa.yaml:4:\n (approximate error location; error nearby after) error calling parser: did not find expected key character 0 position 0 returned: 0","path":"docker\\helm\\voting-system\\templates\\backend-hpa.yaml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line docker\\helm\\voting-system\\templates\\backend-service.yaml:4:\n (approximate error location; error nearby after) error calling parser: did not find expected key character 0 position 0 returned: 0","path":"docker\\helm\\voting-system\\templates\\backend-service.yaml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line docker\\helm\\voting-system\\templates\\frontend-deployment.yaml:4:\n (approximate error location; error nearby after) error calling parser: did not find expected key character 0 position 0 returned: 0","path":"docker\\helm\\voting-system\\templates\\frontend-deployment.yaml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line docker\\helm\\voting-system\\templates\\frontend-service.yaml:4:\n (approximate error location; error nearby after) error calling parser: did not find expected key character 0 position 0 returned: 0","path":"docker\\helm\\voting-system\\templates\\frontend-service.yaml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line docker\\helm\\voting-system\\templates\\networkpolicy.yaml:4:\n (approximate error location; error nearby after) error calling parser: did not find expected key character 0 position 0 returned: 0","path":"docker\\helm\\voting-system\\templates\\networkpolicy.yaml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line docker\\helm\\voting-system\\templates\\postgres-service.yaml:4:\n (approximate error location; error nearby after) error calling parser: did not find expected key character 0 position 0 returned: 0","path":"docker\\helm\\voting-system\\templates\\postgres-service.yaml"},{"code":2,"level":"warn","type":"Other syntax error","message":"Other syntax error at line docker\\helm\\voting-system\\templates\\postgres-statefulset.yaml:4:\n (approximate error location; error nearby after) error calling parser: did not find expected key character 0 position 0 returned: 0","path":"docker\\helm\\voting-system\\templates\\postgres-statefulset.yaml"}],"paths":{"scanned":[".github\\workflows\\backend-ci.yml",".github\\workflows\\frontend-ci.yml",".github\\workflows\\iac-checkov.yml",".github\\workflows\\security-scans.yml",".github\\workflows\\sonarqube.yml",".gitignore","bandit-report.json","docker\\docker-compose.yml","docker\\helm\\voting-system\\Chart.yaml","docker\\helm\\voting-system\\templates\\_helpers.tpl","docker\\helm\\voting-system\\templates\\backend-deployment.yaml","docker\\helm\\voting-system\\templates\\backend-hpa.yaml","docker\\helm\\voting-system\\templates\\backend-service.yaml","docker\\helm\\voting-system\\templates\\frontend-deployment.yaml","docker\\helm\\voting-system\\templates\\frontend-service.yaml","docker\\helm\\voting-system\\templates\\networkpolicy.yaml","docker\\helm\\voting-system\\templates\\postgres-service.yaml","docker\\helm\\voting-system\\templates\\postgres-statefulset.yaml","docker\\helm\\voting-system\\values.yaml","docker\\k8s\\base\\backend-deployment.yaml","docker\\k8s\\base\\backend-hpa.yaml","docker\\k8s\\base\\backend-service.yaml","docker\\k8s\\base\\configmap.yaml","docker\\k8s\\base\\frontend-deployment.yaml","docker\\k8s\\base\\frontend-service.yaml","docker\\k8s\\base\\kustomization.yaml","docker\\k8s\\base\\networkpolicy.yaml","docker\\k8s\\base\\postgres-service.yaml","docker\\k8s\\base\\postgres-statefulset.yaml","docker\\k8s\\base\\secret.yaml","docker\\k8s\\policies\\disallow-privileged.yaml","docker\\k8s\\policies\\gatekeeper\\constraints\\limits.yaml","docker\\k8s\\policies\\gatekeeper\\constraints\\nonroot.yaml","docker\\k8s\\policies\\gatekeeper\\constraints\\privileged.yaml","docker\\k8s\\policies\\gatekeeper\\templates\\limits.yaml","docker\\k8s\\policies\\gatekeeper\\templates\\nonroot.yaml","docker\\k8s\\policies\\gatekeeper\\templates\\privileged.yaml","docker\\k8s\\policies\\postgres-exception.yaml","docker\\k8s\\policies\\require-non-root.yaml","docker\\k8s\\policies\\require-resource-limits.yaml","docs\\architecture.md","docs\\AWS-ARCHITECTURE.md","docs\\AWS-EC2-SETUP.md","docs\\CIS-CHECKLIST.md","docs\\IMPLEMENTATION-SUMMARY.md","docs\\JENKINS-PLUGINS-GUIDE.md","docs\\MANUAL-SETUP-GUIDE.md","docs\\OPERATIONS.md","docs\\presentation\\README.md","docs\\QUICK-START-CHECKLIST.md","docs\\SECURITY-AUTOMATION-GUIDE.md","docs\\srd.md","docs\\TESTING-AUTOMATION-SUMMARY.md","docs\\threat-model.md","docs\\webhook-test.md","iac\\terraform\\environments\\dev\\main.tf","iac\\terraform\\environments\\dev\\provider.tf","iac\\terraform\\environments\\dev\\variables.tf","Jenkinsfile","monitor\\alertmanager\\config.yaml","monitor\\falco\\values.yaml","monitor\\grafana\\dashboard-voting.json","monitor\\grafana\\values.yaml","monitor\\loki\\values.yaml","monitor\\prometheus\\alerts.yaml","monitor\\prometheus\\values.yaml","PROJECT-IMPLEMENTATION-STATUS.md","project.md","proposal.md","README.md","reports\\EXECUTIVE-REPORT.md","reports\\PROJECT-STATUS-REPORT.md","scripts\\harden-ssh.sh","scripts\\README.md","scripts\\setup-auto-updates.sh","scripts\\setup-cloudwatch.sh","scripts\\setup-fail2ban.sh","scripts\\setup-firewall.sh","scripts\\setup-secrets-manager.sh","scripts\\verify-security.sh","sonar-project.properties","src\\backend\\.env.example","src\\backend\\auth.py","src\\backend\\crypto.py","src\\backend\\database.py","src\\backend\\Dockerfile","src\\backend\\main.py","src\\backend\\models.py","src\\backend\\requirements.txt","src\\backend\\start.sh","src\\frontend\\.eslintrc.cjs","src\\frontend\\bandit-report.json","src\\frontend\\Dockerfile","src\\frontend\\eslint-report.json","src\\frontend\\eslint.config.cjs","src\\frontend\\index.html","src\\frontend\\package-lock.json","src\\frontend\\package.json","src\\frontend\\README.md","src\\frontend\\src\\api.js","src\\frontend\\src\\App.jsx","src\\frontend\\src\\components\\ElectionBoard.jsx","src\\frontend\\src\\components\\Login.jsx","src\\frontend\\src\\components\\Register.jsx","src\\frontend\\src\\components\\Vote.jsx","src\\frontend\\src\\main.jsx","src\\frontend\\src\\styles.css","src\\frontend\\vite.config.js","SSDD.pem"]},"time":{"rules":[],"rules_parse_time":3.531325101852417,"profiling_times":{"config_time":6.046672344207764,"core_time":18.034734964370728,"ignores_time":0.004014015197753906,"total_time":24.115468740463257},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":28.407353401184082,"per_file_time":{"mean":0.09564765454944138,"std_dev":0.3563512194807057},"very_slow_stats":{"time_ratio":0.41885140594795717,"count_ratio":0.006734006734006734},"very_slow_files":[{"fpath":"src\\frontend\\package-lock.json","ftime":2.1195762157440186},{"fpath":"src\\backend\\main.py","ftime":9.778883695602417}]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.8857232968881413,"rules_selected_ratio":0.12521026072329688,"rules_matched_ratio":0.12521026072329688},"targets":[],"total_bytes":0,"max_memory_bytes":1456101440},"engine_requested":"OSS","skipped_rules":[],"profiling_results":[]}